\hypertarget{_p_r_o_f_i_l_i_n_g__tools_8c_source}{\section{\-P\-R\-O\-F\-I\-L\-I\-N\-G\-\_\-tools.\-c}
}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{_p_r_o_f_i_l_i_n_g__tools_8h}{PROFILING_tools.h}"}
00002 
\hypertarget{_p_r_o_f_i_l_i_n_g__tools_8c_source_l00037}{}\hyperlink{_p_r_o_f_i_l_i_n_g__tools_8h_ab45d681232a34daa38cb1419306a1bf2}{00037} int32\_t \hyperlink{_p_r_o_f_i_l_i_n_g__tools_8c_ab45d681232a34daa38cb1419306a1bf2}{PROFILER_instance_last_index} = \hyperlink{_p_r_o_f_i_l_i_n_g__tools_8h_adfa1dd598814dd5a5c73276c47cba92d}{PROFILER_INSTANCE_NOT_INITIALIZED};
00038 
00043 \textcolor{keyword}{const} \textcolor{keywordtype}{char}* PROFILER\_files\_names[\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga775939d541e95ea75e6e7066a1cc6bcb}{PROFILER_TOTAL_PROFILERS}] = \{0\};
00044 
00049 \textcolor{keyword}{const} \textcolor{keywordtype}{char}* PROFILER\_procedures\_names[\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga775939d541e95ea75e6e7066a1cc6bcb}{PROFILER_TOTAL_PROFILERS}] = \{0\};
00050 
00055 uint32\_t PROFILER\_lines\_numbers[\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga775939d541e95ea75e6e7066a1cc6bcb}{PROFILER_TOTAL_PROFILERS}] = \{0\};
00056 
00061 uint32\_t PROFILER\_times\_called[\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga775939d541e95ea75e6e7066a1cc6bcb}{PROFILER_TOTAL_PROFILERS}] = \{0\};
00062 
00067 \hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_gae02193769f3b21a09fc0d5035e566a75}{PROFILER_timestruct} PROFILER\_total\_times[\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga775939d541e95ea75e6e7066a1cc6bcb}{PROFILER_TOTAL_PROFILERS}] = \{0\};
00068 
00069 
00070 \textcolor{keyword}{static} \textcolor{keywordtype}{float} PROFILER\_timestamp\_diff\_to\_float(int32\_t PROFILER\_instance\_index)\{
00071     \textcolor{keywordflow}{return} (PROFILER\_total\_times[PROFILER\_instance\_index]).tv\_sec +
00072             (PROFILER\_total\_times[PROFILER\_instance\_index]).tv\_nsec*1.e-9;
00073 \}               
00074                 
00075 \textcolor{keyword}{static} \textcolor{keywordtype}{float} PROFILER\_calculate\_all\_profiles\_average()\{
00076     \textcolor{keywordflow}{return} PROFILER\_timestamp\_diff\_to\_float(\hyperlink{_p_r_o_f_i_l_i_n_g__tools_8h_a39949f1889adb640b9d00c1e794e4038}{PROFILER_GLOBAL_PROFILE_INDEX});
00077 \}                       
00078                         
00079 \textcolor{keyword}{static} \textcolor{keywordtype}{float} PROFILER\_get\_current\_profile\_average(int32\_t 
      PROFILER\_instance\_index)\{
00080     \textcolor{keyword}{static} \textcolor{keywordtype}{float} PROFILER\_total\_average = 
      PROFILER\_calculate\_all\_profiles\_average();
00081     \textcolor{keywordflow}{return} 100*PROFILER\_timestamp\_diff\_to\_float(PROFILER\_instance\_index)/
      PROFILER\_total\_average;
00082 \}                               
00083 
00084 \textcolor{keyword}{static} \textcolor{keywordtype}{void} PROFILER\_log\_instance(uint16\_t PROFILER\_instance\_index)\{
00085         fprintf(stderr,\textcolor{stringliteral}{"[file %s,  line %d,  fun: %s] times called: %u, 
       average: %f%%\(\backslash\)n"},
00086                         PROFILER\_files\_names[PROFILER\_instance\_index],
00087             PROFILER\_lines\_numbers[PROFILER\_instance\_index],
00088                         PROFILER\_procedures\_names[PROFILER\_instance\_index],
00089             PROFILER\_times\_called[PROFILER\_instance\_index],
00090                         PROFILER\_get\_current\_profile\_average(
      PROFILER\_instance\_index));
00091 \}               
00092 
00093         
\hypertarget{_p_r_o_f_i_l_i_n_g__tools_8c_source_l00094}{}\hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga2f57ecff908155818a48144e366f7c57}{00094} \textcolor{keywordtype}{void} \hyperlink{group___xD0_x9F_xD0_xBE_xD1_x80_xD1_x82_xD0_xB8_xD1_x80_xD1_x83_xD0_xB5_xD0_xBC_xD0_xB0_xD1_x8F_2ef1b31e26d7139e4bfe94879d1322e3_ga2f57ecff908155818a48144e366f7c57}{PROFILER_log}()\{
00095         PROFILER\_calculate\_all\_profiles\_average();
00096     \textcolor{keywordflow}{for}(int32\_t PROFILER\_instance\_index = \hyperlink{_p_r_o_f_i_l_i_n_g__tools_8h_a27d5c6f98201a8f99357c6a5c4b82e66}{PROFILER_LOCAL_PROFILES_BEGIN}; 
      PROFILER\_instance\_index<=\hyperlink{_p_r_o_f_i_l_i_n_g__tools_8c_ab45d681232a34daa38cb1419306a1bf2}{PROFILER_instance_last_index}; ++PROFILER\_instance\_index)\{
00097                 PROFILER\_log\_instance(PROFILER\_instance\_index);
00098         \}
00099 \}       
\end{DoxyCode}
